{% extends "base.html" %}

{% block title %}Nodes{% endblock %}

{% block js%}

    <script type="text/javascript" >
function assigne(nodeid,slotid){
    if(nodeid,slotid){
	parameters = "nodeid=" + nodeid + "&slotid=" + slotid;
    }

    new Ajax.Request("/ajassignenodeid2slot", {
			 method: 'post',
			 parameters: parameters,
			 asynchronous: true,
		     });
    search();
}
function search(){
    var parameters = "";
    if($F('slname')){
	parameters = "slname=" + $F('slname');
    }

    new Ajax.Request("/slotlistjson", {
			 method: 'post',
			 parameters: parameters,
			 asynchronous: true,
			 onSuccess: function(ret) {
			     var out = "";
			     if(ret.responseText == -1){
				out = "<font size=20 color=\"red\">NodeID is not specified</font>\n";
			     }else{
				 
				 var j = JSON.parse(ret.responseText);
				 out = "Sorted by slotname{{ nodeid }}\n<table border=\"1\" cellspacing=\"0\" >\n<tr bgcolor=\"yellow\">\n  <td></td><td>ID</td><td>Assigned</td><td>name</td><td>type</td><td>mysel</td><td>mkserial</td><td>vdserial</td></tr>\n";
				 for(i=0;i<j.length;i++){
				     out += "<tr><td><button onClick=\"assigne({{ nodeid }},"+j[i]['id']+");\">assigne</button></td><td>"+j[i]['id']+"</td><td>"+j[i]['node_id']+"</td><td>"+j[i]['name']+"</td><td>"+j[i]['node_type']+"</td><td>"+j[i]['myserial']+"</td><td>"+j[i]['mkserial']+"</td><td>"+j[i]['vdserial']+"</td></tr>";
				 }
			     }
			     $('out').innerHTML = out;
			     
			 }
		     });
}

function startup(){
{#    var myAutoCompleter = new Ajax.Autocompleter(
	'slname', 
	'suggestionBox', 
	'/slotlistsuggest', 
	{
	    paramName: "slname", 
	    minChars: 2
	});
  #}  
}
</script>

<style TYPE="text/css">
div.suggestionBox {
    position:absolute;
    width:500px;
    background-color:white;
    border:1px solid #888;
    margin:0;
    padding:0;
}
div.suggestionBox ul {
    list-style-type:none;
    width:500px;
    margin:0;
    padding:0;
}
div.suggestionBox ul li {
    list-style-type:none;
    width:500px;
    display:block;
    margin:1;
    padding:2px;
    height:40px;
    cursor:pointer;
}
div.suggestionBox ul li.selected { background-color: #ffb;}
</style>

{% endblock %}

{% block bodyparam %}onload="startup();"{% endblock %}


{% block contenthead %}{% endblock %}

{% block content %}
  <H1>{{ hostname }}</h1>
  LineCardName:<input type="text" id="slname" onkeyup="search();" onfocus="search();">
{# <div id="suggestionBox" class="suggestionBox"></div> #}

<div id="out"></div>


{% endblock %}

